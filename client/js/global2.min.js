window.addEventListener('resize', resizecanvas); function toggleslidebar(){documentelemId["slidebar"].classList.toggle('active');}documentelemId["GameCanvas"].addEventListener("load", createcanvas()); window.addEventListener("resize", resizecanvas()); documentelemId["canvaspart"].addEventListener("load", eventlisten()); let btn=documentelemId["helpbutton"]; btn.addEventListener("click", function (){let bgo=document.querySelector(".modal-bg"); bgo.style.opacity=1; bgo.style.visibility="visible"; bgo.style.display="inline";}); let btnclose=documentelemId["closebutton"]; btnclose.addEventListener("click", function (){let bgo=document.querySelector(".modal-bg"); bgo.style.opacity=0; bgo.style.visibility="hidden"; resizecanvas();}); drawanimedicestart(); let btnstart=documentelemId["playbutton"]; let currlink=window.location.href; let linkarr=currlink.split('='); if (linkarr.length > 1){playbtn.disabled=true; setTimeout(function(){if (linkarr.length > 2){let name=''; swal("Joining "+ linkarr[2] +"'s game","Enter your name.Your default name is player1.If you want to change enter the name else press ok",{content: "input",}) .then((value)=>{name=value.replace(/[^a-zA-Z0-9]/g, ""); if(name.length>20) name.slice(0,18); if (name !=null && name !="") names[2]=name; socket.emit('join',{'gid': linkarr[1], 'cid': clientId, 'name': names[2]}); playerid=3; updatezindex(playerid);});}else{swal("Ooops " + name, "Invalid link", "error").then(()=>{let currlink1=window.location.href+"?subha"; let linkarr1=currlink1.split('?'); location.assign(linkarr1[0]);});}},2000);}else{playbtn.innerText="Create Game";}socket.on('start', function (data){gameId=data.gid; clientId=data.cid;}); socket.on('newjoin', function (data){if(playerid==1) swal("Success ", data + " joined this game", "success"); else swal("Success ", " You joined the game.", "success"); if (data !=null && data !="") playername[3]=data; documentelemId["chattext"].innerText="CHAT";}); socket.on('gamedeleted', function (data){swal("Sorry " + name+" Invalid game Code","Create a new game or ask your friend to create a new game.", "error").then(()=>{let currlink1=window.location.href; if(currlink1.includes('index.html',0)) currlink1=window.location.href+"?subha"; else currlink1=window.location.href+"index.html?subha"; let linkarr1=currlink1.split('?'); location.assign(linkarr1[0]);});}); socket.on('startgame', function (data){prgwidth=0; stopcountdown(); timerId=setInterval(countdown,60); gameId=data.gid; playername[1]=data.pl1name; playername[3]=data.pl3name; hideghuti(2); hideghuti(4); if (data.pid==playerid){myturn=true; playbtn.innerText="Play"; playbtn.style.color="white"; turn="red"; playbtn.style.backgroundColor=turn; playbtn.disabled=false;}else{myturn=false; playbtn.innerText="wait for " + playername[1] + "'s move"; playbtn.style.backgroundColor="white"; playbtn.style.color="red"; turn='blue'; playbtn.disabled=true;}}); socket.on('fulljoined', function (data){swal({title: "You are late !", text: " They have started the game.Try a new game?", icon: "warning", buttons: true, dangerMode: true,}) .then((willDelete)=>{if (willDelete){let currlink1=window.location.href; if(currlink1.includes('index.html',0)) currlink1=window.location.href+"?subha"; else currlink1=window.location.href+"index.html?subha"; let linkarr1=currlink1.split('?'); location.assign(linkarr1[0]);}else{let wlink="https://api.whatsapp.com/send?phone=919732273358&text=*Hi%20Subhajit*%20I%20have%20played%20your%20game%20*My%20feedback*%20&source=&data=#"; ;location.assign(wlink);}});}); socket.on('nextmove', (data)=>{prgwidth=0; stopcountdown(); timerId=setInterval(countdown,60); ghutipos=data.g; pos=data.pos; for(let i=0;i<data.boxes.length;i++){if(data.pos[data.boxes[i]].length==1) update1(data.boxes[i]); else if(data.pos[data.boxes[i]].length==2) update2(data.boxes[i]); else if (data.pos[data.boxes[i]].length==4 || data.pos[data.boxes[i]].length==3) update4(data.boxes[i]); else if(data.pos[data.boxes[i]].length >=5 ) updategreater4(data.boxes[i]);}if (data.ply==playerid){myturn=true; if (tut) swal("It's your turn", "Click the play button.", "info"); playbtn.innerText="Play"; playbtn.style.color="white"; playbtn.style.backgroundColor=playercolor[playerid]; playbtn.disabled=false;}else{myturn=false; playbtn.innerText="Wait for "+playername[data.ply]+"'s move"; playbtn.style.color=playercolor[data.ply]; playbtn.style.backgroundColor="white"; playbtn.disabled=true;}}); socket.on('chatmsg', function (data){if (data.ply==playerid){swal("Message sent","Your opponent has recieved message.Enjoy the game! If you got any reply I will inform you.","success")}else{swal(playername[data.ply]+" dropped a message: ",playername[data.ply]+": "+ data.msg+" ");}}); socket.on('diceupdate', function (data){showdice(); let c=0; for (let i=0; i < 4; i++){c +=data.arr[i]; drawdice(data.arr[i], i, "dice" + i);}if (c==0) c=8; if (tut) swal(c + ' ', "Your friend score in this turn.");}); window.addEventListener("orientationchange", function (){if (window.orientation) swal(name + " Please use Potrait mode", "If you use lanscape mode, you may face some issues in landscape mode", "warning");}, false); socket.on("complete",function(data){stopcountdown(); if(data.ply!=playerid){swal("Better luck next time "+ name , "Thanks for playing the game till end.", "error").then(()=>{swal({title: "Do you want to play the game again?", text: "Click on the Create Game button and create new game.Enjoy the game if you found any bug let me know mail:subhajitmahata06@gmail.com ", icon: "success", buttons: true,}).then((willDelete)=>{if (willDelete){let currlink1=window.location.href+"?subha"; let linkarr1=currlink1.split('?'); location.assign(linkarr1[0]);}else{let wlink="https://api.whatsapp.com/send?phone=919732273358&text=*Hi%20Subhajit*%20I%20have%20played%20your%20game%20*My%20feedback*%20&source=&data=#" ;location.assign(wlink);}});});}});